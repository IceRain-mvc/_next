(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5529],{61025:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var r=n(1413),a=n(67294),c={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M518.5 360.3a7.95 7.95 0 00-12.9 0l-178 246c-3.8 5.3 0 12.7 6.5 12.7H381c10.2 0 19.9-4.9 25.9-13.2L512 460.4l105.2 145.4c6 8.3 15.6 13.2 25.9 13.2H690c6.5 0 10.3-7.4 6.5-12.7l-178-246z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"up-circle",theme:"outlined"},o=n(13401),s=function(e,t){return a.createElement(o.Z,(0,r.Z)((0,r.Z)({},e),{},{ref:t,icon:c}))};s.displayName="UpCircleOutlined";var l=a.forwardRef(s)},65529:function(e,t,n){"use strict";n.r(t);var r=n(92809),a=n(28465),c=n(11187),o=n(30266),s=n(65988),l=n(809),u=n.n(l),i=n(67294),f=n(85060),p=n(16596),d=n(61025),x=n(45195),h=n.n(x),m=n(94184),j=n.n(m),v=n(67363),w=n(12836),g=n(85893);function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}i.useLayoutEffect=i.useEffect;var y=["\u8d26\u53f7","\u5bc6\u7801","\u59d3\u540d","\u6240\u5c5e\u9636\u6bb5","\u6240\u5c5e\u90e8\u95e8","eMail","\u90ae\u7bb1","\u624b\u673a\u53f7\u7801","\u8bc1\u4ef6\u53f7\u7801","\u6027\u522b","\u72b6\u6001","\u5907\u6ce8"],k=function(e){var t=[];return e.forEach(function(){var e=(0,o.Z)(u().mark((function e(n){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.push({studentName:n["\u59d3\u540d"]||null,password:n["\u5bc6\u7801"]||null,studentNumber:n["\u8d26\u53f7"]||null,treePersonId:n["\u6240\u5c5e\u9636\u6bb5"]||n["\u6240\u5c5e\u90e8\u95e8"]||null,studentPhone:n["\u624b\u673a\u53f7\u7801"]||null,eMail:n["\u90ae\u7bb1"]||null,studentId:n["\u8bc1\u4ef6\u53f7\u7801"]||null,studentState:"\u7981\u7528"===n["\u72b6\u6001"]?"locked":"active",remark:n["\u5907\u6ce8"]||null,studentSex:n["\u6027\u522b"]&&"\u7537"===n["\u6027\u522b"]?1:0});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),t};t.default=function(e){var t,l=e.layoutImportFlag,x=e.setLayoutImportFlag,m=e.importXlsxFlag,_=e.downImportXlsx,E=(0,i.useState)(!0),O=E[0],Z=E[1],N=(0,i.useState)([]),S=N[0],P=N[1],C=(0,i.useState)([]),I=C[0],U=C[1],z=(0,i.useState)(""),R=z[0],F=z[1],A=(0,i.useRef)(null),D={name:"123456",headers:{authorization:"authorization-text"},onChange:function(e){"uploading"!==e.file.status&&(document.querySelector(".ant-upload-list").style.display="none"),"done"===e.file.status?c.default.success("".concat(e.file.name,"\u52a0\u8f7d\u6210\u529f")):"error"===e.file.status&&c.default.error("".concat(e.file.name,"\u52a0\u8f7d\u5931\u8d25"))}},M=function(){var e=(0,o.Z)(u().mark((function e(t){var r,a,c;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return U([]),P([]),x(!1),e.next=5,Promise.all([n.e(2599),n.e(3524),n.e(4849),n.e(139)]).then(n.t.bind(n,7869,23));case 5:return r=e.sent.default,a=[{}],(c=new FileReader).readAsBinaryString(t),c.onload=function(){var e=(0,o.Z)(u().mark((function e(t){var n,c,o,s,l,i,f,p,d,h;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,c=null===(n=t.target)||void 0===n?void 0:n.result,o=r.read(c,{type:"binary"}),e.t0=u().keys(o.Sheets);case 4:if((e.t1=e.t0()).done){e.next=11;break}if(s=e.t1.value,!o.Sheets.hasOwnProperty(s)){e.next=9;break}return a=r.utils.sheet_to_json(o.Sheets[s]),e.abrupt("break",11);case 9:e.next=4;break;case 11:if(l="",i=a[0],f=[],p=[],d=!0,i["\u8d26\u53f7"]||(l+="\u7f3a\u5c11\u3010\u8d26\u53f7\u3011\u5217\u540d\uff0c\u8bf7\u4e0d\u8981\u4fee\u6539\u6a21\u677f\u540d\uff08\u8d26\u53f7\u53ef\u4ee5\u662f\u624b\u673a\u3001\u5de5\u53f7\u3001\u8eab\u4efd\u8bc1\u7b49\uff09\n",d=!1),i["\u59d3\u540d"]||(l+="\u7f3a\u5c11\u3010\u59d3\u540d\u3011\u5217\u540d\uff0c\u8bf7\u4e0d\u8981\u4fee\u6539\u6a21\u677f\u540d\n\n",d=!1),Object.keys(i).forEach((function(e){y.includes(e)||(l+="\u65e0\u6cd5\u8bc6\u522b\u7684\u5217\u540d: ".concat(e,",\u8bf7\u4e0d\u8981\u4fee\u6539\u6a21\u7248\u5217\u540d\n"),d=!1)})),!d){e.next=24;break}return h=k(a),e.next=24,(0,v.Rh)(h).then((function(e){var t="";null===e||void 0===e||e.list.forEach((function(e){p.push(h[e]),t+="\u7b2c".concat(e+2,"\u884c : \u7cfb\u7edf\u4e2d\u5df2\u7ecf\u5b58\u5728\u8d26\u53f7").concat(a[e]["\u8d26\u53f7"],"\n")})),null===e||void 0===e||e.data.forEach((function(e){f.push(h[e])})),0===p.length?l="\u5bfc\u5165\u6210\u529f".concat(h.length,"\u4e2a\u65b0\u8d26\u53f7\n\n"):(d=!1,l="\u5bfc\u5165\u6210\u529f".concat(h.length-p.length,"\u4e2a\u65b0\u8d26\u53f7\n\n\u4ee5\u4e0b").concat(p.length,"\u4e2a\u8d26\u53f7\u5728\u7cfb\u7edf\u4e2d\u5df2\u7ecf\u5b58\u5728,\u60a8\u53ef\u4ee5\u70b9\u51fb\u5e95\u90e8\u6309\u94ae,\u6267\u884c\u66f4\u65b0\u64cd\u4f5c\n\n").concat(t))})).catch((function(e){console.log(e),(0,w.openNotificationWithIcon)("error","\u5bfc\u5165\u6a21\u5757\u5931\u8d25","")}));case 24:return e.next=26,x(d);case 26:P(f),U(p),F(l),e.next=37;break;case 31:e.prev=31,e.t2=e.catch(0),console.log("\u6587\u4ef6\u7c7b\u578b\u4e0d\u6b63\u786e"),console.log(a),F("\u5bfc\u5165\u6a21\u5757\u5931\u8d25"),(0,w.openNotificationWithIcon)("error","\u6587\u4ef6\u7c7b\u578b\u4e0d\u6b63\u786e","");case 37:case"end":return e.stop()}}),e,null,[[0,31]])})));return function(t){return e.apply(this,arguments)}}(),e.abrupt("return",!1);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();(0,i.useEffect)((function(){try{var e=new Image;e.src="https://www.baidu.com/img/flexible/logo/pc/result.png",e.onload=function(){Z(!0)},e.onerror=function(){Z(!1)}}catch(t){Z(!1)}}),[]),(0,i.useEffect)((function(){return m||l&&(0,o.Z)(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=S.length>0,!e.t0){e.next=4;break}return e.next=4,(0,v.Um)(S);case 4:if(e.t1=I.length>0,!e.t1){e.next=8;break}return e.next=8,(0,v.Ah)(I);case 8:case"end":return e.stop()}}),e)})))(),function(){console.log("\u7ec4\u4ef6\u5378\u8f7d")}}),[m]);var T=function(){var e=(0,o.Z)(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:F("\u6b63\u5728\u6267\u884c\u5bfc\u5165\u6570\u636e, \u8bf7\u7a0d\u5019..."),F("\u5df2\u8986\u76d6\u66f4\u65b0".concat(I.length,"\u4e2a\u8d26\u53f7"));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return O?(0,g.jsxs)("div",{className:"jsx-4058791495 "+(h().import||""),children:[(0,g.jsx)("h4",{style:{marginBottom:"30px"},className:"jsx-4058791495",children:"\u7b2c\u4e00\u6b65\u3001\u4e0b\u8f7d\u5bfc\u5165\u6a21\u677f"}),(0,g.jsxs)("div",{className:"jsx-4058791495 "+(h().down||""),children:[(0,g.jsxs)("a",{href:"https://e.kaoshiyun.com.cn/Resource/User/UserImportTemplate.xls",download:"\u7b80\u5355\u6a21\u7248.xls",className:"jsx-4058791495 "+(h().download||""),children:[(0,g.jsx)(f.Z,{})," \u7b80\u5355\u6a21\u7248 (\u70b9\u51fb\u4e0b\u8f7d)"," "]}),(0,g.jsxs)("a",{href:"https://e.kaoshiyun.com.cn/Resource/User/UserImportTemplateAll.xls",download:"\u5b8c\u6574\u6a21\u7248.xls",className:"jsx-4058791495 "+(h().download||""),children:[(0,g.jsx)(f.Z,{})," \u5b8c\u6574\u6a21\u7248 (\u70b9\u51fb\u4e0b\u8f7d)"," "]})]}),(0,g.jsx)("h4",{style:{margin:"25px 0"},className:"jsx-4058791495",children:"\u7b2c\u4e8c\u6b65\u3001\u4e0a\u4f20\u5bfc\u5165\u6587\u4ef6"}),(0,g.jsx)(a.Z,b(b({},D),{},{beforeUpload:M,maxCount:1,accept:".xlsx,.xls",children:(0,g.jsxs)("button",{className:"jsx-4058791495 "+(h().upload||""),children:[(0,g.jsx)(p.Z,{}),"\u4e0a\u4f20\u5bfc\u5165\u6587\u4ef6"]})})),(0,g.jsx)("textarea",{ref:A,defaultValue:R,className:"jsx-4058791495 "+(j()((t={},(0,r.Z)(t,h().textarea,!0),(0,r.Z)(t,h().textareaError,!(I.length>0)&&!l),(0,r.Z)(t,h().textareaSuccess,I.length>0||l),t))||"")}),(0,g.jsxs)("footer",{className:"jsx-4058791495",children:[I.length>0&&!l&&(0,g.jsxs)("button",{onClick:(0,o.Z)(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x(!0);case 2:return e.next=4,T();case 4:case"end":return e.stop()}}),e)}))),className:"jsx-4058791495 "+(h().cover||""),children:[(0,g.jsx)(d.Z,{})," \u7ee7\u7eed\u5bfc\u5165,\u5e76\u66f4\u65b0\u5df2\u5b58\u5728\u7684\u8d26\u53f7\u4fe1\u606f"]}),(0,g.jsx)("button",{onClick:(0,o.Z)(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F("");case 2:return e.next=4,_();case 4:case"end":return e.stop()}}),e)}))),style:{left:I.length>0&&!l?"-25%":"calc(-50% + 51px)"},className:"jsx-4058791495 "+(h().cancel||""),children:"\u5173\u95ed"})]}),(0,g.jsx)(s.default,{id:"4058791495",children:[]})]}):(0,g.jsx)("div",{className:h().network,children:(0,g.jsx)("p",{children:"\u672a\u68c0\u6d4b\u5230\u7f51\u7edc\u94fe\u63a5"})})}},45195:function(e){e.exports={import:"importExcel_import__thACr",cover:"importExcel_cover__1ursZ",cancel:"importExcel_cancel__oOvEq",textarea:"importExcel_textarea__8TXJo",textareaError:"importExcel_textareaError__N72ft",textareaSuccess:"importExcel_textareaSuccess__TSrQx",download:"importExcel_download__wkdGk",upload:"importExcel_upload__Ft7C5",network:"importExcel_network__f_f70",modal:"importExcel_modal__eJ8_g","ant-modal-content":"importExcel_ant-modal-content__lpriz"}}}]);