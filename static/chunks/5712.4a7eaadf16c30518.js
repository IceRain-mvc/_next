(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5712],{85712:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return U}});var r=n(82891),a=n(35297),s=n(65400),o=n(11187),c=n(12386),i=n(30266),u=n(809),d=n.n(u),l=n(67294),p=n(5152),f=n(79855),h=n.n(f),x=n(91321),m=n(9669),v=n.n(m),j=n(42828);function b(e){return j.A.request({url:"/uploadFile/saveData",method:"POST",data:e})}function _(e){return j.A.request({url:"/uploadFile/deChapterData",method:"DELETE",params:e})}function k(e){return j.A.request({url:"/uploadFile/editorCourseSection",method:"PUT",data:e})}var w=n(85893),y=(0,p.default)((function(){return n.e(8725).then(n.bind(n,92625))}),{loadableGenerated:{webpack:function(){return[92625]},modules:["../src/components/uploads/appUploads/index.tsx -> @/components/alertCommon/alertCommon"]}}),g=(0,p.default)((function(){return Promise.all([n.e(1024),n.e(1566)]).then(n.bind(n,81566))}),{loadableGenerated:{webpack:function(){return[81566]},modules:["../src/components/uploads/appUploads/index.tsx -> @/components/uploads/uploadImg/uploadImg"]}}),I=(0,p.default)((function(){return Promise.all([n.e(1024),n.e(8706),n.e(4304)]).then(n.bind(n,64304))}),{loadableGenerated:{webpack:function(){return[64304]},modules:["../src/components/uploads/appUploads/index.tsx -> @/components/uploads/uploadDocument/uploadDocument"]}}),N=(0,p.default)((function(){return Promise.all([n.e(1024),n.e(8706),n.e(4075)]).then(n.bind(n,19382))}),{loadableGenerated:{webpack:function(){return[19382]},modules:["../src/components/uploads/appUploads/index.tsx -> @/components/uploads/uploadVideo/uploadVideo"]}}),S=v().CancelToken.source(),C=function(e){var t=e.uploadStr,n=e.alertShow,r=e.isChapterName,a=e.chapterId,c=e.updateData,u=e.chapterItem,p=e.functionType,f=e.courseId,m=e.Stop,v=(0,l.useState)(),j=v[0],_=v[1],C=(0,l.useState)(!1),T=C[0],E=C[1],A=(0,l.useState)(!1),Z=A[0],q=A[1],D=(0,x.Z)({scriptUrl:"//at.alicdn.com/t/font_2992472_sdsyff7e51m.js"}),U=(0,l.useState)([{id:0,uploadStr:"graphic",uploadComponent:g},{id:1,uploadStr:"video",uploadComponent:N,isAudioStop:!0},{id:2,uploadStr:"document",uploadComponent:I}])[0],B=function(e){e.courseId=f,e.chapterId=a,e.serialNumber=1,e.serialType=t,_(e)},z=function(){var e=(0,i.Z)(d().mark((function e(t){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t,e.next="save"===e.t0?3:"saveShut"===e.t0?21:"saveNew"===e.t0?43:"Shut"===e.t0?53:56;break;case 3:if(p){e.next=15;break}if(!j.serialName){e.next=12;break}return o.default.loading({content:"\u6b63\u5728\u4fdd\u5b58...",key:"updatable"}),""!==j.fileAddressMp4&&E(!0),e.next=9,b(j);case 9:setTimeout((0,i.Z)(d().mark((function e(){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o.default.success({content:"\u4fdd\u5b58\u6210\u529f",key:"updatable",duration:2}),c(),E(!1),q(!1);case 4:case"end":return e.stop()}}),e)}))),1e3),e.next=13;break;case 12:o.default.warning("\u8bf7\u586b\u5199\u8bfe\u7a0b\u540d\u79f0");case 13:e.next=20;break;case 15:return o.default.loading({content:"\u6b63\u5728\u4fdd\u5b58...",key:"updatable"}),""!==j.fileAddressMp4&&E(!0),e.next=19,k(j);case 19:setTimeout((0,i.Z)(d().mark((function e(){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o.default.success({content:"\u4fdd\u5b58\u6210\u529f",key:"updatable",duration:2}),c(),E(!1),q(!1);case 4:case"end":return e.stop()}}),e)}))),1e3);case 20:return e.abrupt("break",57);case 21:if(p){e.next=33;break}if(!j.serialName){e.next=30;break}return o.default.loading({content:"\u6b63\u5728\u4fdd\u5b58...",key:"updatable"}),""!==j.fileAddressMp4&&E(!0),e.next=27,b(j);case 27:setTimeout((0,i.Z)(d().mark((function e(){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o.default.success({content:"\u5df2\u4fdd\u5b58",key:"updatable",duration:2}),c(),r(!1),E(!1),q(!1);case 5:case"end":return e.stop()}}),e)}))),1e3),e.next=31;break;case 30:o.default.warning("\u8bf7\u586b\u5199\u8bfe\u7a0b\u540d\u79f0");case 31:e.next=42;break;case 33:if(!j.serialName){e.next=41;break}return o.default.loading({content:"\u6b63\u5728\u4fdd\u5b58...",key:"updatable"}),""!==j.fileAddressMp4&&E(!0),e.next=38,k(j);case 38:setTimeout((0,i.Z)(d().mark((function e(){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o.default.success({content:"\u5df2\u4fdd\u5b58",key:"updatable",duration:2}),c(),r(!1),E(!1),q(!1);case 5:case"end":return e.stop()}}),e)}))),1e3),e.next=42;break;case 41:o.default.warning("\u8bf7\u586b\u5199\u8bfe\u7a0b\u540d\u79f0");case 42:return e.abrupt("break",57);case 43:if(!j.serialName){e.next=51;break}return o.default.loading({content:"\u6b63\u5728\u4fdd\u5b58...",key:"updatable"}),""!==j.fileAddressMp4&&E(!0),e.next=48,b(j);case 48:setTimeout((0,i.Z)(d().mark((function e(){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o.default.success({content:" \u6dfb\u52a0\u6210\u529f",key:"updatable",duration:2}),q(!Z),c(),q(!1);case 4:case"end":return e.stop()}}),e)}))),1e3),e.next=52;break;case 51:o.default.warning("\u8bf7\u586b\u5199\u8bfe\u7a0b\u540d\u79f0");case 52:return e.abrupt("break",57);case 53:return""!==j.fileAddressMp4&&E(!0),setTimeout((0,i.Z)(d().mark((function e(){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r(!1),E(!1),q(!1);case 3:case"end":return e.stop()}}),e)}))),100),e.abrupt("break",57);case 56:return e.abrupt("break",57);case 57:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();(0,l.useEffect)((function(){!0===m&&z("Shut")}),[m]);return(0,l.useEffect)((function(){return function(){S.cancel("\u53d6\u6d88\u8bf7\u6c42")}}),[]),(0,w.jsx)("div",{children:(0,w.jsxs)(y,{alertStatus:n,enableDrag:!0,alertTitle:"\u65b0\u589e&\u7f16\u8f91\u7ae0\u8282",changeAlertFlag:function(e){E(!0),setTimeout((0,i.Z)(d().mark((function t(){return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r(e),E(!1),q(!1);case 3:case"end":return t.stop()}}),t)}))),100)},children:[U.map((function(e){return e.uploadStr===t?!0===e.isAudioStop?(0,w.jsx)(e.uploadComponent,{obtainData:B,chapterItem:u,AudioStop:T,clearContents:Z},e.id):(0,w.jsx)(e.uploadComponent,{obtainData:B,chapterItem:u,clearContents:Z},e.id):""})),(0,w.jsxs)("div",{className:h().UploadsBottom,children:[(0,w.jsxs)(s.default,{onClick:function(){z("save")},children:[(0,w.jsx)(D,{style:{fontSize:"20px"},type:"icon-jihuarenwu"}),"\u4fdd\u5b58"]}),(0,w.jsxs)(s.default,{onClick:function(){z("saveShut")},children:[(0,w.jsx)(D,{style:{fontSize:"30px"},type:"icon-daibanrenwu_quxiao"}),"\u4fdd\u5b58\u5e76\u5173\u95ed"]}),p?null:(0,w.jsxs)(s.default,{onClick:function(){z("saveNew")},children:[(0,w.jsx)(D,{style:{fontSize:"20px"},type:"icon-xinzeng"}),"\u4fdd\u5b58\u5e76\u65b0\u589e"]}),(0,w.jsxs)(s.default,{onClick:function(){z("Shut")},children:[(0,w.jsx)(D,{style:{fontSize:"20px"},type:"icon-cuowuguanbiquxiao-xianxingfangkuang"}),"\u5173\u95ed"]})]})]})})},T=n(44587),E=n.n(T);function A(e){return j.A.request({url:"/course-design/design_chapter",method:"GET",params:e})}function Z(e){return j.A.request({url:"/uploadFile/chapterChildren",method:"GET",params:e})}function q(e){return j.A.request({url:"/course-design/editChapterName",method:"PUT",params:e})}var D=n(11163),U=function(e){var t=(0,D.useRouter)().query,n=(0,l.useState)(""),u=n[0],p=n[1],f=(0,l.useState)(!1),h=f[0],m=f[1],b=(0,l.useState)([]),k=b[0],y=b[1],g=(0,l.useState)([]),I=g[0],N=g[1],S=(0,l.useRef)(null),T=(0,l.useState)(!1),U=T[0],B=T[1],z=(0,l.useState)(""),P=z[0],G=z[1],F=(0,l.useState)(!1),M=F[0],O=F[1],R=(0,l.useState)(),H=R[0],L=R[1],V=(0,l.useState)(!1),W=V[0],Q=V[1];console.log(t);var Y={courseId:void 0!==t.courseId?t.courseId:e.courseId},K=v().CancelToken.source();(0,l.useEffect)((function(){e.courseId&&e.courseId.length>0&&function(){var t=(0,i.Z)(d().mark((function t(){var n,r;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,A({courseId:e.courseId});case 2:return(n=t.sent)&&y(n),t.next=6,Z(Y);case 6:(r=t.sent)&&N(r);case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()()}),[e.courseId]);var X=e.getChapterData,J=function(){var n=(0,i.Z)(d().mark((function n(){var r,a;return d().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r={chapterName:"\u7b2c".concat(k.length+1,"\u7ae0"),courseId:void 0!==t.courseId?t.courseId:e.courseId,ids:k[k.length-1]?k[k.length-1].ids+1:1},n.next=3,s=r,j.A.request({url:"/course-design/add_chapter",method:"POST",data:s});case 3:(a=n.sent)&&y(a);case 5:case"end":return n.stop()}var s}),n)})));return function(){return n.apply(this,arguments)}}(),$=function(){var n=(0,i.Z)(d().mark((function n(r,a){var s,o;return d().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return s={id:r,courseId:void 0!==t.courseId?t.courseId:e.courseId},n.next=3,_({chapterId:a});case 3:return n.next=5,c=s,j.A.request({url:"/course-design/delete_chapter",method:"DELETE",params:c});case 5:return n.sent,n.next=8,A(Y);case 8:(o=n.sent)&&y(o),S.current.scrollHeight<=window.innerHeight&&(window.scroll({top:0,left:0,behavior:"smooth"}),B(!1));case 11:case"end":return n.stop()}var c}),n)})));return function(e,t){return n.apply(this,arguments)}}(),ee=function(){var e=(0,i.Z)(d().mark((function e(t,n){var r,a,s;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r={nowId:0,toId:0},!(a=0===t?k[n-1]:k[n+1])){e.next=11;break}return r.nowId=k[n].chapterId,r.toId=a.chapterId,e.next=7,o=r,j.A.request({url:"/course-design/recompose_chapter",method:"PUT",params:o});case 7:return e.next=9,A(Y);case 9:(s=e.sent)&&y(s);case 11:case"end":return e.stop()}var o}),e)})));return function(t,n){return e.apply(this,arguments)}}(),te=function(e){return(0,w.jsxs)(c.default,{children:[(0,w.jsx)(c.default.Item,{children:(0,w.jsx)("a",{href:"#",onClick:function(){ee(0,e)},children:"\u4e0a\u79fb"})},"1"),(0,w.jsx)(c.default.Item,{children:(0,w.jsx)("a",{href:"#",onClick:function(){ee(1,e)},children:"\u4e0b\u79fb"})},"2")]})},ne=(0,l.useState)(""),re=ne[0],ae=ne[1],se=function(e,t){O(!1),L(void 0),ae(t),p(e),m(!0)},oe=(0,x.Z)({scriptUrl:"//at.alicdn.com/t/font_2992472_6nj24f81zbp.js"}),ce=function(){var e=(0,i.Z)(d().mark((function e(t){var n;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_({id:t});case 2:return e.sent,e.next=5,Z(Y);case 5:n=e.sent,N(n),o.default.success("\u5220\u9664\u6210\u529f");case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ie=function(e){o.default.error("\u53d6\u6d88\u5220\u9664")},ue=function(){var e=(0,i.Z)(d().mark((function e(){var t;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Z(Y);case 2:t=e.sent,N(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,l.useEffect)((function(){I.length>0?X(!0):X(!1)}),[I]),(0,l.useEffect)((function(){return function(){K.cancel("\u53d6\u6d88\u8bf7\u6c42")}}),[]);var de=function(e,t){O(!0),L(e),ae(t),p(e.serialType),m(!0)},le=function(){var e=(0,i.Z)(d().mark((function e(t){var n,r;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={courseId:t.courseId,chapterId:t.chapterId,chapterName:P},e.next=3,q(n);case 3:(r=e.sent)&&y(r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,w.jsxs)("div",{children:[(0,w.jsx)("div",{children:k?(0,w.jsxs)("div",{ref:S,className:E().box,children:[(0,w.jsx)("div",{className:E().addBox,children:(0,w.jsx)("div",{children:(0,w.jsxs)("button",{className:E().addBtn,onClick:function(){J()},children:[(0,w.jsxs)("div",{children:[(0,w.jsx)("i",{className:E().iconfont,children:"\ue6e2"})," "]}),(0,w.jsx)("div",{children:"\u521b\u5efa\u8bfe\u7a0b\u7ae0\u8282"})]})})}),k.map((function(e,t){return(0,w.jsxs)("div",{style:{minHeight:"130px",marginBottom:"10px"},children:[(0,w.jsxs)("div",{className:E().editEvents,children:[(0,w.jsx)("div",{className:E().editArea,children:(0,w.jsx)(a.Z,{placement:"bottomLeft",title:(0,w.jsx)("div",{children:(0,w.jsx)("div",{className:E().editInput,children:(0,w.jsx)("input",{type:"text",value:P,onChange:function(e){G(e.target.value)}})})}),onConfirm:function(){le(e)},okText:"\u4fee\u6539",cancelText:"",style:{border:"0px"},icon:"",children:(0,w.jsxs)(s.default,{onClick:function(){G(e.chapterName)},children:[e.chapterName,(0,w.jsx)("i",{className:E().iconfont,children:"\ue616"})]})})}),(0,w.jsxs)("div",{className:E().editEventsRight,children:[(0,w.jsx)("div",{children:(0,w.jsxs)("button",{onClick:function(){$(e.chapterId,e.uids)},style:{padding:"1px 5px"},children:[(0,w.jsx)("div",{children:(0,w.jsx)("i",{className:E().iconfont,children:"\ue615"})}),(0,w.jsx)("div",{children:"\u5220\u9664\u7ae0\u8282\u53ca\u5b50\u7ae0\u8282"})]})}),(0,w.jsx)(r.default,{overlay:te(t),placement:"bottomRight",trigger:["click"],children:(0,w.jsx)("button",{className:E().btns,children:(0,w.jsx)("i",{className:E().iconfont,children:"\ue674"})})},"1")]})]}),(0,w.jsxs)("table",{className:E().title_table,cellSpacing:"0",cellPadding:"0",style:{fontSize:"12px"},children:[(0,w.jsx)("thead",{children:(0,w.jsxs)("tr",{style:{cursor:"move"},children:[(0,w.jsx)("th",{style:{textAlign:"center",width:"2%"},children:"\u5e8f\u53f7"}),(0,w.jsx)("th",{style:{width:"20%"},children:"\u7ae0\u8282\u540d\u79f0"}),(0,w.jsx)("th",{style:{width:"8%"},children:"\u5185\u5bb9"}),(0,w.jsx)("th",{style:{width:"3%",textAlign:"center"},children:"\u7c7b\u578b"}),(0,w.jsx)("th",{style:{width:"2%",textAlign:"center"},children:"\u64cd\u4f5c"})]})}),(0,w.jsx)("tbody",{children:I?I.map((function(t,n){return t.chapterId===e.uids?(0,w.jsxs)("tr",{style:{cursor:"pointer"},children:[(0,w.jsx)("td",{style:{textAlign:"center"},children:n+1}),(0,w.jsx)("td",{style:{color:"#2972ab"},onClick:function(){de(t,e.uids)},children:t.serialName}),(0,w.jsx)("td",{style:{},title:t.fileName?t.fileName:t.serialContent,children:t.fileName?t.fileName:t.serialContent?t.serialContent.length>20?t.serialContent.slice(0,20)+"...":t.serialContent:""}),(0,w.jsx)("td",{style:{textAlign:"center"},children:"graphic"===t.serialType?"\u56fe\u6587":"video"===t.serialType?"\u89c6\u9891":"document"===t.serialType?"\u6587\u6863":""}),(0,w.jsxs)("td",{style:{height:"45px",display:"flex",alignItems:"center",flexDirection:"row",justifyContent:"space-around"},children:[(0,w.jsx)("div",{onClick:function(){de(t,e.uids)},children:(0,w.jsx)(oe,{style:{fontSize:"20px"},type:"icon-bianji"})}),(0,w.jsx)(a.Z,{title:"\u786e\u5b9a\u8981\u5220\u9664\u6b64\u4efb\u52a1\u5417?",onConfirm:function(){ce(t.id)},onCancel:ie,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",style:{height:"0",width:"0"},children:(0,w.jsx)(oe,{style:{fontSize:"20px"},type:"icon-shanchu"})})]})]},n):null})):null})]}),(0,w.jsxs)("div",{className:E().footerEvents,children:[(0,w.jsxs)("button",{onClick:function(){se("graphic",e.uids)},children:[(0,w.jsx)("div",{children:(0,w.jsx)("i",{className:E().iconfont,children:"\ue789"})}),(0,w.jsx)("div",{children:"\u6dfb\u52a0\u56fe\u6587"})]}),(0,w.jsxs)("button",{onClick:function(){se("video",e.uids)},children:[(0,w.jsx)("div",{children:(0,w.jsx)("i",{className:E().iconfont,children:"\ue6cc"})}),(0,w.jsx)("div",{children:"\u6dfb\u52a0\u89c6\u9891"})]}),(0,w.jsxs)("button",{onClick:function(){se("document",e.uids)},children:[(0,w.jsx)("div",{children:(0,w.jsx)("i",{className:E().iconfont,children:"\ue61b"})}),(0,w.jsx)("div",{children:"\u6dfb\u52a0\u6587\u6863"})]})]})]},e.chapterId)})),!0===U?(0,w.jsx)("div",{className:E().addBox,style:{zIndex:"999"},children:(0,w.jsx)("div",{children:(0,w.jsxs)("button",{className:E().addBtn,onClick:function(){J()},children:[(0,w.jsxs)("div",{children:[(0,w.jsx)("i",{className:E().iconfont,children:"\ue6e2"})," "]}),(0,w.jsx)("div",{children:"\u521b\u5efa\u8bfe\u7a0b\u7ae0\u8282"})]})})}):null]}):null}),(0,w.jsx)(C,{uploadStr:u,alertShow:h,isChapterName:function(e){Q(!0),m(e)},chapterId:re,updateData:ue,chapterItem:H,functionType:M,courseId:e.courseId,Stop:W})]})}},79855:function(e){e.exports={UploadsBottom:"appUploads_UploadsBottom__0YWq_"}},44587:function(e){e.exports={UploadsBottom:"uploads_UploadsBottom__E3O82",drapDown:"uploads_drapDown__GLd2h",box:"uploads_box__Fz_t_",addBox:"uploads_addBox__vXyOL",addBtn:"uploads_addBtn__Cwcow",editName:"uploads_editName__HFHO8",editEvents:"uploads_editEvents__k48xn",editEventsRight:"uploads_editEventsRight__qZzA0",editEventsNowTo:"uploads_editEventsNowTo___q9ga",editEventsNowToI:"uploads_editEventsNowToI__w9ETO",nowTo:"uploads_nowTo__WMvuK",btns:"uploads_btns__ESW81",editSub:"uploads_editSub__ROQ6v",title_table:"uploads_title_table__l84wl",footerEvents:"uploads_footerEvents__3hvv3",iconfont:"uploads_iconfont__lA8wk",editArea:"uploads_editArea__pjpVf",editInput:"uploads_editInput__YGx5y",uploadImg:"uploads_uploadImg__pfQVP"}}}]);